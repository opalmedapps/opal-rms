<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
        <title>Virtual Waiting Room Menu</title>
        <base href="/orms/">

        <script src="node_modules/angular/angular.min.js"></script>
        <script src="node_modules/angular-cookies/angular-cookies.min.js"></script>
        <script src="VirtualWaitingRoom/js/config.js"></script>

  </head>
  <body ng-app="myApp" ng-controller="main" style="color: rgb(0, 0, 0); background-color: rgb(128,128,128); font-size:18px; font-family: Helvetica,Arial,sans-serif;" link="#0000ee" vlink="#551a8b" alink="#ee0000">

<center>
<div style="width: 1000px; background-color: rgb(255, 255, 255); font-size:24px;">
    <table style="text-align: left; font-size:24px;" border="0" cellpadding="2" cellspacing="10">
    <tbody>

    <tr style="font-family: Helvetica,Arial,sans-serif;">
    <td></td>
    <td style="vertical-align: center; background-color: rgb(255, 255, 255);">
        <center><img height="150" src="{{rmsLogo}}" alt="logo" border="0"></center>
    </td>
    <td></td>
    </tr>

        <tr style="font-family: Helvetica,Arial,sans-serif;">
    <td></td>
    <td style="vertical-align: center; background-color: rgb(111,84,153);">
        <span style="font-weight: bold; color: rgb(255,255,255); font-size:40px;">
            <center>Virtual Waiting Room Menu</center>
        </span>
    </td>
    <td></td>
        </tr>

        <tr style="font-family: Helvetica,Arial,sans-serif;">
    <td></td>
    <td style="vertical-align: center; background-color: rgb(255,255,255);">
        <span style="color: rgb(0,0,0);font-size:30px;">
        Please select your virtual waiting room from one of the links below:
        </span><br>
    </td>
    <td></td>
        </tr>
    </tbody>
    </table>

    <table style="width: 1000px; font-size:24px;">
    <tr style="padding-bottom: 5px;">
        <th style="text-align: center" ng-repeat="(category,profiles) in profileList"><span style="border-bottom: 1px solid black;">{{category}}</span></th>
    </tr>
    <tr><td><br></td></tr>
    <tr>
        <td style="text-align: center; vertical-align: baseline;" ng-repeat="(category,profiles) in profileList">
            <p ng-repeat="profile in profiles">
                <a href="VirtualWaitingRoom/virtualWaitingRoom?profile={{profile.ProfileId}}&clinicHub={{clinicHubId}}">{{profile.ProfileId}}</a>
            </p>
        </td>
    </tr>
    </table>

    <div style="width: 1000px; background-color: rgb(255, 255, 255);">
        <hr><center> <a href="./">Main Page</a></center>
    </div>
</div>

</center>

<script>
var app = angular.module('myApp', ['ngCookies', 'vwr.config']);

app.config(["$locationProvider",function ($locationProvider)
{
    $locationProvider.html5Mode({
        enabled: true,
        requireBase: false,
        rewriteLinks: false
    });
}]);

app.controller('main', function($scope, $location, $http, $cookies, CONFIG)
{
    let speciality = $cookies.get("specialityGroupId");
    $scope.clinicHubId = $cookies.get("clinicHubId");

    $scope.rmsLogo    = CONFIG.BRANDING_RMS_LOGO_PATH;

    $scope.profileList = {};
    //get list of profiles available
    $http({
        method: "GET",
        url: "php/api/private/v1/profile/getList",
        params: {speciality: speciality}
    })
    .then( response => {
        response.data.data.forEach( x => {
            $scope.profileList[x.Category] = $scope.profileList[x.Category] || [];
            $scope.profileList[x.Category].push(x);
        });
    });

});

</script>
</body>
</html>
